<!DOCTYPE html>
<html lang="en">

    <head>

        <title>Researcher Home</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <style>

            #top {
                padding-bottom: 20px;
            }

            #an_text {
                width: 800px;
            }

            .token {
                border-width: 5px;
                font: 20px lucida-console, monospace;
            }

        </style>

        <script type="text/javascript" src="../lib/ajax.js"></script>
        <script type="text/javascript" src="../lib/redirect.js"></script>
        <script type="text/javascript" src="../lib/checkPrivileges.js"></script>
        <script type="text/javascript">
            checkPrivileges("researcher");
        </script>
        <script type="text/javascript" src="javascript/divs/controlDivs.js"></script>
        <script type="text/javascript" src="javascript/divs/lib.js"></script>
        <script type="text/javascript" src="javascript/divs/filter.js"></script>
        <script type="text/javascript" src="javascript/divs/upload.js"></script>
        <script type="text/javascript" src="javascript/divs/viewDetails.js"></script>
        <script type="text/javascript" src="javascript/divs/analyse.js"></script>
        <script type="text/javascript" src="javascript/divs/compare.js"></script>
        <script type="text/javascript" src="javascript/controlTextTable.js" defer></script>
        <script type="text/javascript" src="javascript/setupTextTable.js" defer></script>

    </head>

    <body>

        <div id="top">
            <input id="but_fil" type="button" onclick="showFilterDiv()" value="Filter" />
            <input id="but_new" type="button" onclick="showUploadDiv(true)" value="New Text" />
            <input id="but_ver" type="button" onclick="showUploadDiv(false)" value="New Version" disabled />
            <input id="but_view" type="button" onclick="showViewDetailsDiv()" value="View Details" disabled />
            <input id="but_ana" type="button" onclick="showAnalyseDiv()" value="Analyse" disabled />
            <input id="but_comp" type="button" onclick="showCompareDiv()" value="Compare" disabled />
            <input id="but_hide" type="button" onclick="hideDivs()" value="Hide" disabled />
        </div>

        <div id="middle"></div>

            <div id="fil" hidden>

                <form id="fil_reset"></form>

                Title Keywords
                <input id="fil_search" form="fil_reset" type="text" placeholder="Search" /><br>

                Ownership
                <select id="fil_type" form="fil_reset">
                    <option value="all">All</option>
                    <option value="owned">Owned</option>
                    <option value="unowned">Unowned</option>
                </select><br>

                Minimum target age
                <input id="fil_min_age" form="fil_reset" type="number" value="0" /><br>

                Maximum target age
                <input id="fil_max_age" form="fil_reset" type="number" value="255" /><br>

                <input id="filter_button" type="button"
                onclick="filterTexts(fil_search.value, fil_type.value, fil_min_age.value, fil_max_age.value)"
                value="Filter" />

            </div>

            <div id="up" hidden>

                <form id="up_reset"></form>

                <div class="left">
                    Title <input id="up_title" type="text" /><br>
                    Version  <input id="up_ver" form="up_reset" type="text" /><br>
                    File <input id="up_file" form="up_reset" type="file" /><br>
                    Make Version's Text and Associated Reading Data Public
                    <input id="up_is_public" form="up_reset" type="checkbox" /><br>
                </div>

                <div class="right">

                    Minimum Reader Age
                    <input form="up_reset" type="checkbox" onchange="up_min_age.disabled = !up_min_age.disabled;" />
                    <input id="up_min_age" form="up_reset" type="number" disabled /><br>

                    Maximum Reader Age
                    <input form="up_reset" type="checkbox" onchange="up_max_age.disabled = !up_max_age.disabled;" />
                    <input id="up_max_age" form="up_reset" type="number" disabled /><br>

                    Reader Gender
                    <input form="up_reset" type="checkbox" onchange="up_gender.disabled = !up_gender.disabled;" />
                    <select id="up_gender" form="up_reset" disabled>
                        <option value="m">Male</option>
                        <option value="f">Female</option>
                    </select>

                    <!-- Should add an impairment selector -->

                </div>

                <input type="button" onclick="upload()" value="Upload" />

            </div>

            <div id="view" hidden>

                <div id="view_title_line">
                    Title: <span id="view_title"></span>
                </div>
                <div id="view_ver_line">
                    Version: <span id="view_ver"></span>
                </div>
                <div id="view_owner_line">
                    Uploader: <span id="view_uploader"></span>
                </div>
                <div id="view_priv_line">
                    Privacy Level: <span id="view_privacy"></span>
                </div>
                <div id="view_min_age_line">
                    Target Age Minimum: <span id="view_min_age"></span>
                </div>
                <div id="view_max_age_line">
                    Target Age Maximum: <span id="view_max_age"></span>
                </div>
                <div id="view_gen_line">
                    Target Gender: <span id="view_gender"></span>
                </div>
                <div id="view_text_line">
                    Text:
                </div>
                <div id="view_text"></div>

            </div>

            <div id="an" hidden>

                <div>
                    <h2 id="an_title"></h2> <h2 id="an_version"></h2>
                </div>
                <div>
                    Average:
                    <select id="an_average_sel" onchange="analysisInterface.statisticDisplayer.changeAverage(this.value)">
                        <option value="mean">Mean</option>
                        <option value="median">Median</option>
                    </select>
                </div>
                <div>
                    Token:
                    <select id="an_token_sel" onchange="analysisInterface.statisticDisplayer.changeToken(this.value)">
                        <option value="char">Character</option>
                        <option value="word">Word</option>
                        <option value="clause">Clause</option>
                        <option value="sentence">Sentence</option>
                    </select>
                </div>
                <div>
                    Statistic:
                    <select id="an_statistic_sel" onchange="analysisInterface.statisticDisplayer.changeStatistic(this.value)">
                        <option value="gazeDuration">Gaze Duration</option>
                        <option value="firstFixationDuration">First-Fixation Duration</option>
                        <option value="spilloverTime">Spillover Time</option>
                        <option value="totalReadingTime">Total Reading Time</option>
                        <option value="regressionsInCount">Regressions In (quantity)</option>
                        <option value="regressionsInTime">Regressions In (time)</option>
                        <option value="regressionsOutCount">Regressions Out (quantity)</option>
                        <option value="regressionsOutTime">Regressions Out (time)</option>
                    </select>
                </div>
                <div>
                    Gender:
                    <select id="an_gender_sel" onchange="analysisInterface.statisticDisplayer.changeFilter('gender', this.value)">
                        <option value="all">All</option>
                        <option value="m">Male</option>
                        <option value="f">Female</option>
                    </select>
                </div>
                <div>
                    Reading Impairment:
                    <select id="an_impairment_sel" onchange="analysisInterface.statisticDisplayer.changeFilter('impairment', this.value)">
                        <option value="all">All</option>
                        <option value="y">Only Impaired</option>
                        <option value="n">Only Non-Impaired</option>
                    </select>
                </div>
                <div>
                    Minimum age: <input id="an_min_age" type="number" min="0" max="255" value="0" onchange="analysisInterface.statisticDisplayer.changeFilter('minAge', this.value)" />
                    Maximum age: <input id="an_max_age" type="number" min="0" max="255" value="255" onchange="analysisInterface.statisticDisplayer.changeFilter('maxAge', this.value)" />
                </div>
                <div>
                    Minimum Words Per Minute: <input id="an_min_wpm" type="number" min="0" max="500" value="0" onchange="analysisInterface.statisticDisplayer.changeFilter('minWPM', this.value)" />
                    Maximum Words Per Minute: <input id="an_max_wpm" type="number" min="0" max="500" value="500" onchange="analysisInterface.statisticDisplayer.changeFilter('maxWPM', this.value)" />
                </div>
                <div>
                    Minimum Screen Width: <input id="an_min_inner_width" type="number" min="0" max="2000" value="0" onchange="analysisInterface.statisticDisplayer.changeFilter('minInnerWidth', this.value)" />
                    Maximum Screen Width: <input id="an_max_inner_width" type="number" min="0" max="2000" value="2000" onchange="analysisInterface.statisticDisplayer.changeFilter('maxInnerWidth', this.value)" />
                </div>
                <input type="button" onclick="readingManager.download(false)" value="Download JSON" />
                <input type="button" onclick="readingManager.download(true)" value="Download CSV" />

                <br><br>

                <div id="an_text"></div>

            </div>

            <div id="comp" hidden>

                <select id="comp_average_sel" onchange="comparisonManager.updateComparison()">
                    <option value="mean">Mean</option>
                    <option value="median">Median</option>
                </select>
                <input type="checkbox" onclick="">
                <br>

                <table>
                    <thead>
                        <tr>
                            <th>Text</th>
                            <th>Reading Speed (wpm)</th>
                            <th>Gaze Duration (ms)</th>
                            <th>Number of Regressions (%)</th>
                            <th>Regression Path Duration (ms)</th>
                            <!--
                                give different views: graphs, heatmaps, tables
                                maybe link these via mousehover, etc.
                                also give standard deviation, etc.
                                Comparisons by demographic is also useful
                             -->
                        </tr>
                    </thead>
                    <tbody id="comp_table_body"></tbody>
                </table>

            </div>

            <br><br>

            <table>
                <thead>
                    <th>Unselected</th>
                    <th>Selected</th>
                </thead>
                <tbody id="texts"></tbody>
            </table>

        </div>

    </body>

</html>
